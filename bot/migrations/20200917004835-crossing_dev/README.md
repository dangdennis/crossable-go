# Migration `20200917004835-crossing_dev`

This migration has been generated by Dennis Dang at 9/17/2020, 12:48:35 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."RaidAttack" DROP COLUMN "id",
ADD COLUMN "raidBossId" text  NOT NULL ;

ALTER TABLE "public"."RaidAttackOnRaids" DROP CONSTRAINT IF EXiSTS "RaidAttackOnRaids_avatarId_fkey";

ALTER TABLE "public"."RaidAttackOnRaids" DROP CONSTRAINT IF EXiSTS "RaidAttackOnRaids_raidBossId_fkey";

ALTER TABLE "public"."RaidAttackOnRaids" DROP CONSTRAINT IF EXiSTS "RaidAttackOnRaids_raidId_fkey";

ALTER TABLE "public"."RaidAttack" ADD FOREIGN KEY ("raidBossId")REFERENCES "public"."RaidBoss"("id") ON DELETE CASCADE  ON UPDATE CASCADE

DROP TABLE "public"."RaidAttackOnRaids";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200917004835-crossing_dev
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,94 @@
+datasource db {
+    provider = "postgresql"
+    url      = "postgresql://postgres:postgres@localhost:5432/crossing_dev"
+}
+
+generator db {
+    provider = "go run github.com/prisma/prisma-client-go"
+}
+
+model User {
+    id            String    @default(cuid()) @id
+    createdAt     DateTime  @default(now())
+    deletedAt     DateTime?
+    updatedAt     DateTime  @updatedAt
+    discordUserId String    @unique
+    email         String    @unique
+    name          String?
+    avatar        Avatar
+}
+
+model Avatar {
+    id             String           @default(cuid()) @id
+    createdAt      DateTime         @default(now())
+    deletedAt      DateTime?
+    updatedAt      DateTime         @updatedAt
+    User           User             @relation(fields: [userId], references: [id])
+    userId         String
+    RaidAttack     RaidAttack[]
+    AvatarsOnRaids AvatarsOnRaids[]
+}
+
+model Raid {
+    id                 String              @default(cuid()) @id
+    createdAt          DateTime            @default(now())
+    deletedAt          DateTime?
+    updatedAt          DateTime            @updatedAt
+    startTime          DateTime            @default(now())
+    endTime            DateTime?
+    completionProgress Float               @default(0)
+    active             Boolean
+    playerLimit        Int
+    RaidAttack         RaidAttack[]
+    AvatarsOnRaids     AvatarsOnRaids[]
+    RaidBossesOnRaids  RaidBossesOnRaids[]
+}
+
+model RaidBoss {
+    id                String              @default(cuid()) @id
+    createdAt         DateTime            @default(now())
+    deletedAt         DateTime?
+    updatedAt         DateTime            @updatedAt
+    name              String
+    image             String?
+    RaidBossesOnRaids RaidBossesOnRaids[]
+    RaidAttack        RaidAttack[]
+}
+
+model RaidAttack {
+    createdAt  DateTime  @default(now())
+    deletedAt  DateTime?
+    updatedAt  DateTime  @updatedAt
+    raid       Raid      @relation(fields: [raidId], references: [id])
+    raidId     String
+    avatar     Avatar    @relation(fields: [avatarId], references: [id])
+    avatarId   String
+    RaidBoss   RaidBoss  @relation(fields: [raidBossId], references: [id])
+    raidBossId String
+
+    @@id([raidId, avatarId, raidBossId])
+}
+
+model AvatarsOnRaids {
+    createdAt DateTime  @default(now())
+    deletedAt DateTime?
+    updatedAt DateTime  @updatedAt
+    raid      Raid      @relation(fields: [raidId], references: [id])
+    raidId    String
+    avatar    Avatar    @relation(fields: [avatarId], references: [id])
+    avatarId  String
+
+    @@id([raidId, avatarId])
+}
+
+model RaidBossesOnRaids {
+    createdAt  DateTime  @default(now())
+    deletedAt  DateTime?
+    updatedAt  DateTime  @updatedAt
+    raid       Raid      @relation(fields: [raidId], references: [id])
+    raidId     String
+    raidBoss   RaidBoss  @relation(fields: [raidBossId], references: [id])
+    raidBossId String
+
+    @@id([raidId, raidBossId])
+}
```


