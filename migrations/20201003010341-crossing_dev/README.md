# Migration `20201003010341-crossing_dev`

This migration has been generated by Dennis Dang at 10/3/2020, 1:03:41 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."Message" ADD COLUMN "sequence" integer  NOT NULL ;

ALTER TABLE "public"."MessagesOnActions" DROP CONSTRAINT IF EXiSTS "MessagesOnActions_messageId_fkey";

ALTER TABLE "public"."MessagesOnEvents" DROP CONSTRAINT IF EXiSTS "MessagesOnEvents_eventId_fkey";

ALTER TABLE "public"."MessagesOnEvents" DROP CONSTRAINT IF EXiSTS "MessagesOnEvents_messageId_fkey";

DROP TABLE "public"."MessagesOnActions";

DROP TABLE "public"."MessagesOnEvents";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201003004818-crossing_dev..20201003010341-crossing_dev
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
     provider = "postgresql"
-    url = "***"
+    url      = "postgresql://postgres:postgres@localhost:5432/crossing_dev"
 }
 generator db {
     provider = "go run github.com/prisma/prisma-client-go"
@@ -95,19 +95,18 @@
 }
 // An Event represents a moment in a story in which Avatars can fulfill Actions
 model Event {
-    id               Int                @id @default(autoincrement())
-    createdAt        DateTime           @default(now())
-    deletedAt        DateTime?
-    updatedAt        DateTime           @updatedAt
-    story            Story              @relation(fields: [storyId], references: [id])
-    storyId          Int
+    id        Int       @id @default(autoincrement())
+    createdAt DateTime  @default(now())
+    deletedAt DateTime?
+    updatedAt DateTime  @updatedAt
+    story     Story     @relation(fields: [storyId], references: [id])
+    storyId   Int
     // The sequence dictates the order of events to occur in a story
-    sequence         Int
-    occurred         Boolean            @default(false)
-    Action           Action[]
-    MessagesOnEvents MessagesOnEvents[]
+    sequence  Int
+    occurred  Boolean   @default(false)
+    Action    Action[]
     @@unique([storyId, sequence])
 }
@@ -124,40 +123,39 @@
     @@unique([eventId, avatarId])
 }
-// A Message holds message contents.
+// A Message indicates its type of message (i.e. event message, player message), its sequence, and its content.
 model Message {
-    id                Int                 @id @default(autoincrement())
-    createdAt         DateTime            @default(now())
-    deletedAt         DateTime?
-    updatedAt         DateTime            @updatedAt
-    content           String
-    type              String
-    MessagesOnEvents  MessagesOnEvents[]
-    MessagesOnActions MessagesOnActions[]
-}
-
-// A MessagesOnActions joins a particular message to an Action based on its sequence.
-model MessagesOnActions {
+    id        Int       @id @default(autoincrement())
     createdAt DateTime  @default(now())
     deletedAt DateTime?
     updatedAt DateTime  @updatedAt
-    message   Message   @relation(fields: [messageId], references: [id])
-    messageId Int
+    content   String
+    type      String
     sequence  Int
-
-    @@id([messageId, sequence])
 }
-// An Event may send messages to users on completion.
-model MessagesOnEvents {
-    createdAt DateTime  @default(now())
-    deletedAt DateTime?
-    updatedAt DateTime  @updatedAt
-    message   Message   @relation(fields: [messageId], references: [id])
-    messageId Int
-    event     Event     @relation(fields: [eventId], references: [id])
-    eventId   Int
+// // A MessagesOnActions dictates what message corresponds to an action. It depends on the Avatar's raid team position.
+// model MessagesOnActions {
+//     createdAt DateTime  @default(now())
+//     deletedAt DateTime?
+//     updatedAt DateTime  @updatedAt
+//     message   Message   @relation(fields: [messageId], references: [id])
+//     messageId Int
+//     sequence  Int
-    @@id([messageId, eventId])
-}
+//     @@id([messageId, sequence])
+// }
+
+// // An Event may send messages to users on completion.
+// model MessagesOnEvents {
+//     createdAt DateTime  @default(now())
+//     deletedAt DateTime?
+//     updatedAt DateTime  @updatedAt
+//     message   Message   @relation(fields: [messageId], references: [id])
+//     messageId Int
+//     event     Event     @relation(fields: [eventId], references: [id])
+//     eventId   Int
+
+//     @@id([messageId, eventId])
+// }
```


