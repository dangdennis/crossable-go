# Migration `20201003004424-crossing_dev`

This migration has been generated by Dennis Dang at 10/3/2020, 12:44:24 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."MessagesOnActions" DROP CONSTRAINT IF EXiSTS "MessagesOnActions_actionId_fkey",
DROP COLUMN "actionId",
ADD COLUMN "sequence" integer  NOT NULL ;
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201003003823-crossing_dev..20201003004424-crossing_dev
--- datamodel.dml
+++ datamodel.dml
@@ -1,7 +1,7 @@
 datasource db {
     provider = "postgresql"
-    url = "***"
+    url      = "postgresql://postgres:postgres@localhost:5432/crossing_dev"
 }
 generator db {
     provider = "go run github.com/prisma/prisma-client-go"
@@ -112,17 +112,16 @@
 }
 // An Action indicates that an Avatar has taken action for an Event
 model Action {
-    id                Int                 @id @default(autoincrement())
-    createdAt         DateTime            @default(now())
-    deletedAt         DateTime?
-    updatedAt         DateTime            @updatedAt
-    event             Event               @relation(fields: [eventId], references: [id])
-    eventId           Int
-    avatar            Avatar              @relation(fields: [avatarId], references: [id])
-    avatarId          Int
-    MessagesOnActions MessagesOnActions[]
+    id        Int       @id @default(autoincrement())
+    createdAt DateTime  @default(now())
+    deletedAt DateTime?
+    updatedAt DateTime  @updatedAt
+    event     Event     @relation(fields: [eventId], references: [id])
+    eventId   Int
+    avatar    Avatar    @relation(fields: [avatarId], references: [id])
+    avatarId  Int
     @@unique([eventId, avatarId])
 }
@@ -133,23 +132,22 @@
     deletedAt         DateTime?
     updatedAt         DateTime            @updatedAt
     content           String
     type              String
+    MessagesOnEvents  MessagesOnEvents[]
     MessagesOnActions MessagesOnActions[]
-    MessagesOnEvents  MessagesOnEvents[]
 }
-// An Action may send messages to users.
+// A MessagesOnActions joins a particular message to an Action based on its sequence.
 model MessagesOnActions {
     createdAt DateTime  @default(now())
     deletedAt DateTime?
     updatedAt DateTime  @updatedAt
     message   Message   @relation(fields: [messageId], references: [id])
     messageId Int
-    action    Action    @relation(fields: [actionId], references: [id])
-    actionId  Int
+    sequence  Int
-    @@id([messageId, actionId])
+    @@id([messageId])
 }
 // An Event may send messages to users on completion.
 model MessagesOnEvents {
```


